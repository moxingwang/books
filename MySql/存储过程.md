#### 存储过程
    DELIMITER //
    CREATE DEFINER=`root`@`%` PROCEDURE `tx_pc_serial_number_generator`(IN `_series_name` VARCHAR(255), IN `_default_start_value` bigint, OUT `_current_value` bigint, OUT `_series_format` VARCHAR(255), OUT `_prefix` VARCHAR(255), OUT `_current_date` datetime)
    BEGIN
        DECLARE _step						int			default 1;
        DECLARE _days_between			int 			default 0;
        
            
            START TRANSACTION; 
            
            SELECT current_value,`current_date`,step,series_format,prefix
                FROM tx_serial_number_generator
                where series_name = _series_name 
                into _current_value,_current_date,_step,_series_format,_prefix;
                
                
            set _days_between = TO_DAYS(NOW()) - TO_DAYS(_current_date);
            
            if  _days_between > 0 then
                set _current_value = _default_start_value;
            else
                set _current_value = _current_value + _step;
            end if;
            
            
            set _current_date = now();
        
            update tx_serial_number_generator set current_value = _current_value, `current_date` = _current_date  where series_name = _series_name ;
          
          COMMIT;
    
    END//
    DELIMITER ;
